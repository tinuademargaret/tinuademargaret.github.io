<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> An overview of language model (Part 1) | Tinuade Margaret </title> <meta name="author" content="Tinuade Margaret"> <meta name="description" content="Where we started"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tinuademargaret.github.io/blog/2022/language-model-overview-1/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Tinuade</span> Margaret </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">An overview of language model (Part 1)</h1> <p class="post-meta"> November 14, 2022 </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/ai"> <i class="fa-solid fa-hashtag fa-sm"></i> AI</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Language generation by humans is a sequential process. In acts of communication like speaking or writing, language is generated one word at a time and a preceding word or sequence of words would determine the next word depending on the rules of the language in use and the words one is familiar with in that language. A language model mimics this process by predicting the next word given a previous word or sequence of words. It makes this prediction by computing the probability distribution over a vocabulary of words(all the words the model is aware of) which shows how likely each word in the vocabulary would be the next word.</p> <p>For example, given the input sequence “I love playing”, a trained language model is able to predict that the next word is most likely to be “football” rather than “bread”.</p> <p>Language modelling is a fundamental task in NLP and it is used as the basis of other NLP tasks such as machine translation, text summarization etc. Notice that each of these tasks involves the generation of some text given some input context.</p> <p>Prior to the adoption of the use of deep learning techniques in NLP tasks, language modelling was done using statistical modelling with the dominant approach being the n-gram LM.</p> <h2 id="n-gram-language-models">n-gram Language Models</h2> <p>A sequence of n-words is what is said to be an n-gram. In a 1-gram model, the sentence “I am a girl” is chunked into sequences of 1 word as <em>(I) (am) (a) (girl)</em> and each chunk is known as a <em>unigram</em>, likewise in a 2-gram model, the same sentence is chunked as <em>(I am) (am a) (a girl)</em> and each chunk is known as a <em>bigram</em>.</p> <p>An n-gram LM calculates the probability distribution using the Markov assumption that the next word in a sequence only depends on the previous n-1 words. If n is 2 then the probability distribution is estimated on a one-word history. A number of successful n-gram models made use of a value of n=5.</p> <p>n-gram models performed well with small values of n but the performance decreased with larger values of n. This is not far-fetched as the probability of finding long sequences in a text corpus is low and this lowers the chances of the sequence being included as part of the training data. Also with larger values of n, the model becomes increasingly complex. The size of the context being modelled in an n-gram is a limitation to the model as it cannot capture long-range dependencies which are often seen in natural language.</p> <p>The n-gram model also fails to capture semantic relationships between contexts. For example, we can tell that two contexts like “The Tempest was written by William Shakespeare” and “The author of The Tempest is William Shakespeare” mean the same, an n-gram model fails to recognize and capture this similarity.</p> <p>The limitations of the n-gram models have been greatly improved upon by the adoption of deep learning techniques in performing language modelling tasks. These kinds of language models are called Neural Language Models.</p> <h2 id="neural-language-models">Neural Language Models</h2> <p>In this approach, a feature vector usually one dimensional, is associated with each word in a vocabulary, the probability function which is used in n-gram LMs is replaced by a neural network and is now expressed as the conditional probability of predicting the next word given the previous ones. As with neural networks in general, the parameters of the function is tuned in an iterative manner with the objective of minimizing the prediction error of the network.</p> <p>This approach obtained significantly better results compared to the best of the n-gram models. The neural network learns similar words and represents them with similar vector features which makes the language model generalize better. The success of neural language models naturally gives way to more complex neural language models with better performance which we would look at “in my next post”. Irrespective of the architecture of these models, there are some key components that are common to them. These components include:</p> <h3 id="embedding-layer">Embedding Layer</h3> <p>So far we have talked about the input to an LM as a sequence of words and we have talked about calculating the probability of the next word given a sequence of words, but we have not explained how we map words into numerical data to enable the performance of numerical computations.</p> <p>Usually, the mapping of words to numerical data known as <em>Word embeddings</em> is done via <em>one hot encoding</em>. In one hot encoding, every word in a vocabulary is represented as a vector of size |V| which is the length of the vocabulary(i.e the total number of words that needs to be encoded). The position of the particular word being represented is set to a value of 1 while every other word’s position in the vocabulary is set to 0. This data quickly becomes large as the size of the vocabulary increases. Also when this data is fed into a neural network a lot of computation goes on for data that is mostly zeros which is quite inefficient.</p> <p>An improvement to this was the addition of an embedding layer (the feature vector associated with each word described above) to the neural network. The embedding layer in this case is randomly initialised and jointly trained with the rest of the network layers. The matrix formed by the feature vectors then forms an embedding lookup table |E| of length |V|.</p> <p>The <a href="https://arxiv.org/pdf/1301.3781.pdf" rel="external nofollow noopener" target="_blank">word2vec paper</a> proposed a word embedding model, which pre-trains word embeddings that are used to initialise the word embedding layer in an LM. This further improved the performance of neural language models on a range of NLP tasks.</p> <h3 id="softmax-layer">Softmax Layer</h3> <p>Language modelling can be seen as a multiclass classification task with the number of classes equal to the length of the vocabulary |V|. To make the output of the LM a probability distribution over a vocabulary of words, the softmax layer has weights similar to the embedding layer and the softmax activation function is used to transform the output into a probability distribution.</p> <p>In a continuation post we would look at different Neural Model Architectures including the recent and popular Transformers.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Tinuade Margaret. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>